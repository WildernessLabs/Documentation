<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Wilderness Labs : UART</title>
        <meta name="description" content="Documentation">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">    
    </head>
    <body>

        <div class="top-container">
            <!--<h4><a class="brand" href="/">Wilderness Labs</a>
    <small>Documentation</small>
</h4>-->
 <!-- Static navbar -->
 <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand logo" href="http://wildernesslabs.co"><img src="/images/WLabsHeaderLogo.png" data-rjs="/images/WLabsHeaderLogo@2x.png" ></a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li ><a href="http://wildernesslabs.co/Netduino">Netduino</a></li>
              <li><a href="http://community.wildernesslabs.co">Community</a></li>
              <li class="active"><a href="/">Documentation</a></li>
              <li class="dropdown">
                <a href="http://blog.wildernesslabs.co" >Blog <!--<span class="caret"></span>--></a>
                <!--<ul class="dropdown-menu">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                  <li><a href="#">Something else here</a></li>
                  <li role="separator" class="divider"></li>
                  <li class="dropdown-header">Nav header</li>
                  <li><a href="#">Separated link</a></li>
                  <li><a href="#">One more separated link</a></li>
                </ul>-->
              </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <!--<li><a href="../navbar-fixed-top/">Sign in</a></li>-->
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->
      </nav>
            
        </div>
			<div class="container">
            	<div class="main-content">
                <div class="row">
                    
                    
                        <div id="navigation" class="col-sm-3">
                            <!--
<div class="NavHeader">Meadow</div>
<ul class="navigation">
    <li class="active"><a href="#">Getting Started</a></li>
</ul>
-->

<div class="NavHeader">Netduino</div>
<ul class="navigation">
    <!--<li class="active"><a href="/Netduino/Getting_Started">Getting Started</a></li>-->
    <li><a href="/Netduino/Getting_Started">Getting Started</a></li>
    <li><a href="/Netduino/About">About Netduino</a>
        <ul>
            <li><a href="/Netduino/About/Updating_Firmware">Updating Firmware</a></li>
           <li><a href="/Netduino/About/Downloads">Downloads</a></li>
           <li><a href="/Netduino/About/Source">Source Files</a></li>
        </ul>
    </li>
    <li><a href="/Netduino/Input_Output">IO</a>
        <ul>
            <li><a href="/Netduino/Input_Output/Analog/">Analog</a></li>
            <li><a href="/Netduino/Input_Output/Digital/">Digital</a>
                <ul>
                    <li><a href="/Netduino/Input_Output/Digital/I2C/">I2C Overview</a>
                        <ul>
                            <li><a href="/Netduino/Input_Output/Digital/I2C/Reading">Reading from an I2C Device</a></li>
                            <li><a href="/Netduino/Input_Output/Digital/I2C/Writing">Writing to an I2C Device</a></li>
                        </ul>
                    </li>
                    <li><a href="/Netduino/Input_Output/Digital/SPI/">SPI</a></li>
                    <li><a href="/Netduino/Input_Output/Digital/PWM/">PWM</a></li>
                    <li><a href="/Netduino/Input_Output/Digital/UART/">UART (Serial)</a></li>
                </ul>
            </li>
            <li><a href="/Netduino/Input_Output/Onboard_Button_+_LED/">Onboard Button and LED</a></li>
            <li><a href="/Netduino/Input_Output/File_Storage/">SD Card/File IO</a></li>
            <li><a href="/Netduino/Input_Output/Network/">Network</a></li>
        </ul>
    </li>
    <li><a href="/Netduino/Application_Fundamentals/">Application Fundamentals</a>
        <ul>
            <li><a href="/Netduino/Application_Fundamentals/NETMF/">.NET MicroFramework</a></li>
            <!--<li><a href="/Netduino/Application_Fundamentals/Memory_Management/">Memory Management</a></li>-->
        </ul>
    </li>
    <!--
    <li><a href="/Netduino/Peripherals/">Peripherals</a>
        <ul>
            <li><a href="/Netduino/Peripherals/LEDs/">LEDs</a></li>
            <li><a href="/Netduino/Peripherals/Switches/">Switches</a></li>
            <li><a href="/Netduino/Peripherals/Sensors/">Sensors</a></li>
            <li><a href="/Netduino/Peripherals/Motors/">Motors</a></li>
            <li><a href="/Netduino/Peripherals/Shields/">Shields</a></li>
            <li><a href="/Netduino/Peripherals/Relays/">Relays</a></li>
            <li><a href="/Netduino/Peripherals/Bluetooth/">Bluetooth</a></li>
        </ul>
    </li>
    -->
</ul>


<div class="NavHeader">Hardware & Circuits</div>
<ul class="navigation">
    <li><a href="/Hardware/Tutorials/">Tutorials</a>
        <ul>
            <li><a href="/Hardware/Tutorials/Electronics/">Electronics Tutorial</a>
                <ul>
                    <li><a href="/Hardware/Tutorials/Electronics/Part1/Atoms/">Part 1 - Physics of Electricity</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/Part1/Atoms/">Atoms</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part1/Electrical_Current/">Electrical Current</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part1/Electromagnetism/">Electromagnetism</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part1/Review/">Review</a></li>
                        </ul>
                    </li>
                    <li><a href="/Hardware/Tutorials/Electronics/Part2/Amount_and_Force">Part 2 - Amps, Volts, and Watts</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Amount_and_Force">Amount &amp; Force</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Amperage">Amperage</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Voltage">Voltage</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Wattage">Wattage</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Source_Load_and_Ground">Source, Load, and Ground</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part2/Review">Review</a></li>
                        </ul>
                    </li>
                    <li><a href="/Hardware/Tutorials/Electronics/Part3/Current_Types">Part 3 - Current Types; AC &amp; DC</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/Part3/Current_Types">Current Types</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part3/Direct_Current">Direct Current (DC)</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part3/Alternating_Current">Alternating Current (AC)</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part3/AC_Characteristics">AC Characteristics</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part3/Review">Review</a></li>
                        </ul>
                    </li>
                    <li><a href="/Hardware/Tutorials/Electronics/Part4/Resistance">Part 4 - Resistance &amp; Ohm's Law</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Resistance">Resistance &amp; Ohms</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Ohms_Law">Ohm's Law</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Calculating_Resistance">Calculating Simple Resistance</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Resistor_Power_Rating">Resistor Power Rating</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Series_Resistance">Series Resistance</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Parallel_Resistance">Parallel Resistance</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Reading_Resistors">Reading Resistor Values</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Resistor_Tolerance">Resistor Tolerance</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part4/Review">Review</a></li>
                        </ul>
                    </li>
                    <!--
                    <li><a href="/Hardware/Tutorials/Electronics/Part5/Kirchhoffs_First_Law">Part 5 - Kirchhoff's Laws and Voltage</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/Part5/Kirchhoffs_First_Law">Kirchhoff's First Law</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part5/Kirchhoffs_Second_Law">Kirchhoff's Second Law</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part5/Voltage_Division">Voltage Divsion</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/Part5/Review">Review</a></li>
                        </ul>
                    </li>
                    -->
                    <!--
                    <li><a href="/Hardware/Tutorials/Electronics/PartX/Batteries">Part X - Batteries</a>
                        <ul>
                            <li><a href="/Hardware/Tutorials/Electronics/PartX/Batteries">Batteries</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/PartX/Battery_Types">Battery Types</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/PartX/Battery_Circuits">Battery Circuits</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/PartX/Battery_Resistance">Battery Resistance</a></li>
                            <li><a href="/Hardware/Tutorials/Electronics/PartX/Review">Review</a></li>
                        </ul>
                    </li>
                    -->
                    <!--
                    <li><a href="/Hardware/Tutorials/Electronics/Part5/">Part 5 - DC Circuit Basics</a></li>
                    -->
                </ul>
            </li>
            <!--
            <li><a href="/Hardware/Tutorials/PCB_Design/">PCB Design</a>
                <ul>
                    <li><a href="/Hardware/Tutorials/PCB_Design/Choosing_Components/">Choosing Components</a></li>
                </ul>
            </li>
            -->
        </ul>
    </li>
    <li><a href="/Hardware/Reference/">Reference</a>
        <ul>
            <!--<li><a href="/Hardware/Reference/Algorithms">Algorithms</a></li>-->

            <li><a href="/Hardware/Reference/Components">Components</a>
                <ul>
                    <li><a href="/Hardware/Reference/Components/Packages_and_Sizes">Packages and Sizes</a></li>
                    <li><a href="/Hardware/Reference/Components/Capacitors">Capacitors</a></li>
                    <li><a href="/Hardware/Reference/Components/Diodes">Diodes</a></li>
                    <li><a href="/Hardware/Reference/Components/LEDs">LEDs</a>
                        <ul>
                            <li><a href="/Hardware/Reference/Components/LEDs/Driving_w_PWM/">Driving with PWM</a></li>
                            <li><a href="/Hardware/Reference/Components/LEDs/Driving_w_Resistor/">Driving with a Resistor</a></li>
                        </ul>
                    </li>
                    <li><a href="/Hardware/Reference/Components/Relays">Relays</a></li>
                    <li><a href="/Hardware/Reference/Components/Resistors">Resistors</a>
                        <ul>
                            <li><a href="/Hardware/Reference/Components/Resistors/Reading">Reading a Resistor's Value</a></li>
                        </ul>
                    </li>
                </ul>
            </li>


            <li><a href="/Hardware/Reference/Equations_and_Laws">Equations and Laws</a>
                <ul>
                    <!--<li><a href="/Hardware/Reference/Equations_and_Laws/Capacitance">Capacitance</a></li>-->
                    <li><a href="/Hardware/Reference/Equations_and_Laws/Voltage">Voltage</a>
                        <ul>
                            <!--<li><a href="/Hardware/Reference/Equations_and_Laws/Voltage/Division">Division</a></li>-->
                            <li><a href="/Hardware/Reference/Equations_and_Laws/Voltage/Ohms_Law">Ohm's Law</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="/Hardware/Reference/Units">Units</a>
                <ul>
                    <li><a href="/Hardware/Reference/Units/Amps">Amps</a></li>
                    <li><a href="/Hardware/Reference/Units/Volts">Volts</a></li>
                    <li><a href="/Hardware/Reference/Units/Watts">Watts</a></li>
                </ul>
            </li>
        </ul>
    </li>
</ul>

<!--
<div class="NavHeader">Product Lifecycle</div>
<ul class="navigation">
    <li><a href="/Product_Design_Lifecycle/Conceptual_Design/">Conceptual Design</a></li>
    <li><a href="/Product_Design_Lifecycle/Schematic_Design">Schematic Design</a></li>
    <li><a href="/Product_Design_Lifecycle/Breadboard_Prototyping">Breadboard Prototyping</a></li>
    <li><a href="/Product_Design_Lifecycle/Programming">Programming</a></li>
    <li><a href="/Product_Design_Lifecycle/PCBs">PCBs</a>
        <ul>
            <li><a href="/Product_Design_Lifecycle/PCBs/Prototyping">PCB Prototyping</a></li>
            <li><a href="/Product_Design_Lifecycle/PCBs/Fabrication">PCB Fabrication</a></li>
            <li><a href="/Product_Design_Lifecycle/PCBs/Assembly">PCB Assembly</a></li>
            <li><a href="/Product_Design_Lifecycle/PCBs/Solder_Masks">Solder Masks</a></li>
            <li><a href="/Product_Design_Lifecycle/PCBs/Surface_Finishes">PCB Finishes</a></li>
        </ul>
    </li>
    <li><a href="/Product_Design_Lifecycle/Industrial_Design">Industrial Design</a></li>
    <li><a href="/Product_Design_Lifecycle/Mass_Production">Mass Production</a>
        <ul>
            <li><a href="/Product_Design_Lifecycle/Mass_Production/USB_VendorIDs">USB Vendor IDs</a></li>
            <li><a href="/Product_Design_Lifecycle/Mass_Production/MAC_Addresses">MAC Addresses</a></li>
            <li><a href="/Product_Design_Lifecycle/Mass_Production/UPCs_EANs">UPCs and EANs</a></li>
            <li><a href="/Product_Design_Lifecycle/Mass_Production/Certifications">Important Certifications</a></li>
        </ul>
    </li>
</ul>
-->

<div class="NavHeader"><a href="/Samples">Sample Projects</a></div>
<ul class="navigation">
    <li><a href="/Samples/Netduino/Blinky">Blinky</a></li>
    <li><a href="/Samples/Netduino/OnboardButtonAndLed">Onboard Button + LED</a></li>
    <li><a href="/Samples/Netduino/ButtonInterruptEvents">Button Interrupt Events</a></li>
    <li><a href="/Samples/Netduino/GlitchFilter">Glitch Filtering</a></li>
    <li><a href="/Samples/Netduino/DrivingLED_w_PWM/">LED w/PWM</a></li>
    <li><a href="/Samples/Netduino/RgbLed/">RGB LED</a></li>
    <li><a href="/Samples/Netduino/RGB_Blinky/">RGB Blinky LED</a></li>
    <li><a href="/Samples/Netduino/PotentiometerControlled_RgbLed/">RGB LED with Potentiometer</a></li>
    <li><a href="/Samples/Netduino/SDCardIO/">SD Card IO</a></li>
    <li><a href="/Samples/Netduino/WebRequest/">Web Request</a></li>
</ul>

                        </div>

                        <div id="content" class="col-sm-9">
                            <div class="page-header">
    <h2>UART
        
    </h2>
</div>

<p>Universal Asynchronous Receiver / Transmitter (UART) is a device used to transfer data between two devices.  Data is broken down into a series of bits and transferred to the receiver sequentially.  A second UART in the receiver reassembles the bits into the original data.  The protocol allows for data to be transmitted over a single data line.  Bi-directional communication is established by using two data lines.</p>

<p>The data lines are normally labelled R<sub>x</sub> for receive and T<sub>x</sub> for transmit.  It is important to remember that when connecting two devices together the R<sub>x</sub> line of the receiver should be connected to the T<sub>x</sub> line of the transmitter.  For bi-directional communication, this crossing of signal lines should be repeated.</p>

<h3 id="serial-port-properties">Serial Port Properties</h3>

<p>Serial ports rely upon the transmitter and the receiver being configured identically.  A mismatch in the properties can result in a communication failure.  The four properties most associated with a UART are:</p>

<ul>
  <li>Baud rate</li>
  <li>Number of data bits</li>
  <li>Number of stop bits</li>
  <li>Parity</li>
</ul>

<h3 id="voltage-levels">Voltage Levels</h3>

<p>The UART on the Netduino and many other microcontrollers operate at <a href="https://en.wikipedia.org/wiki/Transistor%E2%80%93transistor_logic">TTL (Transistor - Transistor Logic)</a> levels.  On the Netduino this is 3.3V on other microcontrollers this may be 5V.</p>

<p>One serial protocol commonly used is <a href="https://en.wikipedia.org/wiki/RS-232">RS-232</a>.  RS-232 allows the voltage levels to vary between -15V and + 15V.  It is important not to connect a Netduino to circuits working at these voltage levels as this will damage the Netduino.  <a href="http://www.ti.com/lit/ds/symlink/max232.pdf">The MAX232 series of conversion chips</a> are available to translate between Netduino and RS-232 voltage levels.</p>

<h1 id="uart-pins-on-the-netduino">UART Pins on the Netduino</h1>

<p>There are four UARTs available on the Netduino:</p>

<p><img src="../../../About/Netduino3_Pinout.svg" alt="Netduino Pinout" /></p>

<h1 id="simple-transmitter-and-receiver">Simple Transmitter and Receiver</h1>

<p>Simple serial communication can be illustrated by making the Netduino talk to itself using two of the four available serial ports.  In this simple scenario one of the com ports (COM1) will transmit data while a second port (COM4) will listen to the data being transmitted and display the messages in the debug console.</p>

<h2 id="hardware">Hardware</h2>

<p>The simple example under consideration requires only two wires and a Netduino.</p>

<p>Connect R<sub>x</sub> of COM1 to SCL (T<sub>x</sub> of COM4) and T<sub>x</sub> of COM1 to SDA (R<sub>x</sub> of COM4).</p>

<h2 id="software">Software</h2>

<p>The following example has COM1as the transmitter and COM4 as the receiver:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Ports</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.SPOT</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">UARTTest</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
		<span class="c1">/// &lt;summary&gt;
</span>		<span class="c1">/// Two com ports, one sender and one receiver.
</span>		<span class="c1">/// &lt;/summary&gt;
</span>		<span class="c1">/// &lt;remarks&gt;
</span>		<span class="c1">/// Note that the transmitter and the receiver must be configured to use the
</span>		<span class="c1">/// same baud rate, number of bits etc.
</span>		<span class="c1">/// &lt;/remarks&gt;
</span>		<span class="k">static</span> <span class="n">SerialPort</span> <span class="n">transmitter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SerialPort</span><span class="p">(</span><span class="s">"COM1"</span><span class="p">,</span> <span class="m">9600</span><span class="p">,</span> <span class="n">Parity</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">StopBits</span><span class="p">.</span><span class="n">One</span><span class="p">);</span>
		<span class="k">static</span> <span class="n">SerialPort</span> <span class="n">receiver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SerialPort</span><span class="p">(</span><span class="s">"COM4"</span><span class="p">,</span> <span class="m">9600</span><span class="p">,</span> <span class="n">Parity</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">StopBits</span><span class="p">.</span><span class="n">One</span><span class="p">);</span>

		<span class="c1">/// &lt;summary&gt;
</span>		<span class="c1">/// Timer object generates and event periodically to transmit data to the receiver.
</span>		<span class="c1">/// &lt;/summary&gt;
</span>        <span class="k">static</span> <span class="n">Timer</span> <span class="n">timer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Timer</span><span class="p">(</span><span class="n">Timer_Interrupt</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">2000</span><span class="p">);</span>

		<span class="c1">/// &lt;summary&gt;
</span>		<span class="c1">/// Variables to hold information about the messages being transmitted and received.
</span>		<span class="c1">/// &lt;/summary&gt;
</span>        <span class="k">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
		<span class="k">static</span> <span class="kt">string</span> <span class="n">messageBeingReceived</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>

		<span class="c1">/// &lt;summary&gt;
</span>		<span class="c1">/// The entry point of the program, where the program control starts and ends.
</span>		<span class="c1">/// &lt;/summary&gt;
</span>		<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">transmitter</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
            <span class="n">receiver</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
			<span class="n">receiver</span><span class="p">.</span><span class="n">DataReceived</span> <span class="p">+=</span> <span class="n">SerialDataReceived</span><span class="p">;</span>
			<span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">Timeout</span><span class="p">.</span><span class="n">Infinite</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span>		<span class="c1">/// Process data from the serial port(s)
</span>        <span class="c1">/// &lt;/summary&gt;
</span>        <span class="c1">/// &lt;param name="sender"&gt;Serial port that is receiving the data.&lt;/param&gt;
</span>        <span class="c1">/// &lt;param name="e"&gt;Event information.&lt;/param&gt;
</span>        <span class="k">static</span> <span class="k">void</span> <span class="nf">SerialDataReceived</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SerialDataReceivedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
			<span class="k">if</span> <span class="p">((</span><span class="n">e</span><span class="p">.</span><span class="n">EventType</span> <span class="p">==</span> <span class="n">SerialData</span><span class="p">.</span><span class="n">Chars</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">sender</span> <span class="p">==</span> <span class="n">receiver</span><span class="p">))</span>
			<span class="p">{</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">BUFFER_SIZE</span> <span class="p">=</span> <span class="m">1024</span><span class="p">;</span>
				<span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>

				<span class="kt">int</span> <span class="n">amount</span> <span class="p">=</span> <span class="p">((</span><span class="n">SerialPort</span><span class="p">)</span><span class="n">sender</span><span class="p">).</span><span class="nf">Read</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">BUFFER_SIZE</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="kt">char</span><span class="p">[]</span> <span class="n">characters</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetChars</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">index</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">index</span> <span class="p">&lt;</span> <span class="n">amount</span><span class="p">;</span> <span class="n">index</span><span class="p">++)</span>
					<span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">==</span> <span class="sc">'\n'</span><span class="p">)</span>
						<span class="p">{</span>
							<span class="n">Debug</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="s">"Message received: "</span> <span class="p">+</span> <span class="n">messageBeingReceived</span><span class="p">);</span>
							<span class="n">messageBeingReceived</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">else</span>
						<span class="p">{</span>
							<span class="n">messageBeingReceived</span> <span class="p">+=</span> <span class="n">characters</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span>        <span class="c1">/// Periodic interrupt generated by the timer.
</span>        <span class="c1">/// &lt;/summary&gt;
</span>        <span class="c1">/// &lt;param name="state"&gt;State.&lt;/param&gt;
</span>        <span class="k">static</span> <span class="k">void</span> <span class="nf">Timer_Interrupt</span><span class="p">(</span><span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">transmitter</span><span class="p">.</span><span class="n">IsOpen</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">count</span><span class="p">++;</span>
                <span class="n">String</span> <span class="n">messageToSend</span> <span class="p">=</span> <span class="n">count</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">Debug</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="s">"Sending message: "</span> <span class="p">+</span> <span class="n">messageToSend</span><span class="p">);</span>
                <span class="n">messageToSend</span> <span class="p">+=</span> <span class="s">"\n"</span><span class="p">;</span>
                <span class="n">transmitter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">messageToSend</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="n">messageToSend</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="key-program-elements">Key Program Elements</h2>

<p>The first task is to create variables for the serial ports:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="c1">/// &lt;summary&gt;
/// Two com ports, one sender and one receiver.
/// &lt;/summary&gt;
/// &lt;remarks&gt;
/// Note that the transmitter and the receiver must be configured to use the
/// same baud rate, number of bits etc.
/// &lt;/remarks&gt;
</span><span class="k">static</span> <span class="n">SerialPort</span> <span class="n">transmitter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SerialPort</span><span class="p">(</span><span class="s">"COM1"</span><span class="p">,</span> <span class="m">9600</span><span class="p">,</span> <span class="n">Parity</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">StopBits</span><span class="p">.</span><span class="n">One</span><span class="p">);</span>
<span class="k">static</span> <span class="n">SerialPort</span> <span class="n">receiver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SerialPort</span><span class="p">(</span><span class="s">"COM4"</span><span class="p">,</span> <span class="m">9600</span><span class="p">,</span> <span class="n">Parity</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">StopBits</span><span class="p">.</span><span class="n">One</span><span class="p">);</span>
</code></pre>
</div>

<p>Once created it is necessary to open the com ports:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">transmitter</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
<span class="n">receiver</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
</code></pre>
</div>

<p>An event handler is used to process any data received on the <em>receiver</em> serial port:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">receiver</span><span class="p">.</span><span class="n">DataReceived</span> <span class="p">+=</span> <span class="n">SerialDataReceived</span><span class="p">;</span>
</code></pre>
</div>

<p>The messages are held in .NET <em>string</em> objects.  The <em>Encoding.UTF8.GetBytes</em> method converts the <em>string</em> objects into an array of bytes that can be transmitted over the serial port:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">transmitter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">messageToSend</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="n">messageToSend</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</code></pre>
</div>

<p>The <em>Write</em> method transmits a sequence of bytes to the receiver.</p>

<p>The most complex part of this application is the <em>SerialDataReceived</em> event.  The method is complex due to the way in which the method is called.  The <em>SerialDataReceived</em> method seems to be called randomly.  For instance, sending <em>123456789</em> may generate two calls to the event handler, one of <em>1234</em> and a second for <em>56789</em>.  The event handler needs to take this into consideration when reassembling the messages.  In this case, the newline character “\n” is used as an end of message marker.  Characters are added to the message buffer until a newline is encountered.  At this point the message is considered complete and a new message is started.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">static</span> <span class="k">void</span> <span class="nf">SerialDataReceived</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SerialDataReceivedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">e</span><span class="p">.</span><span class="n">EventType</span> <span class="p">==</span> <span class="n">SerialData</span><span class="p">.</span><span class="n">Chars</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">sender</span> <span class="p">==</span> <span class="n">receiver</span><span class="p">))</span>
	<span class="p">{</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">BUFFER_SIZE</span> <span class="p">=</span> <span class="m">1024</span><span class="p">;</span>
		<span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>

		<span class="kt">int</span> <span class="n">amount</span> <span class="p">=</span> <span class="p">((</span><span class="n">SerialPort</span><span class="p">)</span><span class="n">sender</span><span class="p">).</span><span class="nf">Read</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">BUFFER_SIZE</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">char</span><span class="p">[]</span> <span class="n">characters</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetChars</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">index</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">index</span> <span class="p">&lt;</span> <span class="n">amount</span><span class="p">;</span> <span class="n">index</span><span class="p">++)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">==</span> <span class="sc">'\n'</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">Debug</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="s">"Message received: "</span> <span class="p">+</span> <span class="n">messageBeingReceived</span><span class="p">);</span>
					<span class="n">messageBeingReceived</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">else</span>
				<span class="p">{</span>
					<span class="n">messageBeingReceived</span> <span class="p">+=</span> <span class="n">characters</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="logic-analyser-output">Logic Analyser Output</h2>

<p>Hooking up the logic analyser and looking at the first message generates the following output:</p>

<p><img src="SerialDataTransmission.png" alt="Serial UART Transmission" /></p>

<p>The white dots show the points where the protocol analyser is expecting to read a bit of data.  The brown line shows the value that is being read.</p>

<h1 id="program-output">Program Output</h1>

<p>Running the above application generates the following output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Sending message: 1
Message received: 1
Sending message: 2
Message received: 2
Sending message: 3
Message received: 3
Sending message: 4
Message received: 4
</code></pre>
</div>

<h1 id="further-reading">Further Reading</h1>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Universal_asynchronous_receiver/transmitter">Wikipedia article describing UARTs</a></li>
  <li><a href="http://www.ti.com/lit/ds/symlink/max232.pdf">MAX232 Datasheet</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Transistor%E2%80%93transistor_logic">TTL (Transistor - Transistor Logic)</a></li>
  <li><a href="https://en.wikipedia.org/wiki/RS-232">RS-232</a> serial communication</li>
</ul>

<h1 id="related-hardware">Related Hardware</h1>

<p>A number of cables and boards are available to connect TTL serial ports on the Netduino to a PC or Mac over USB.  Examples include:</p>

<ul>
  <li><a href="https://www.sparkfun.com/search/results?term=ftdi">Sparkfuns FTDI boards and cables</a></li>
  <li><a href="https://www.adafruit.com/product/70">FDTI Cable</a></li>
  <li><a href="https://www.adafruit.com/product/954">USV to TTL Serial Cable</a></li>
  <li><a href="https://www.adafruit.com/product/284">FTDI Friend</a></li>
</ul>

<!--
# Project Ideas

- Build a Xamarin Forms application to communicate with the Netduino over USB
- Add a Bluetooth board and connect your mobile phone to your Netduino
-->


                        </div>
                    
                </div>

                

                <div class="row">
                    <div id="footer" class="col-sm-12">
                        <!-- Wilderness Labs - We Power Connected Things -->
<!-- Footer HTML Starts -->
<div class="container footer-main-wrap">
    <div class="row white-background">
        <div class="col-md-2 col-sm-2 col-xs-12 footer_logo footer_column">
            <a href="#"><img src="/images/White_Mountain_Footer_Logo.svg" class="footer-logo"/></a>
        </div>
        <div class="col-md-2 col-sm-2 col-xs-6  footer_column">
            <span class="list-heading">Products</span>
            <ul class="footer-ul">
                <li><a href="http://www.wildernesslabs.co/Netduino">Netduino 2 & 3</a></li>
            </ul>
        </div>
        
        <div class="col-md-2 col-sm-2 col-xs-6  footer_column">
            <span class="list-heading">Developer Center</span>
            <ul class="footer-ul">
                <li><a href="http://developer.wildernesslabs.co/Netduino/Getting_Started/">Getting Started</a></li>
                <li><a href="http://developer.wildernesslabs.co/Samples/">Samples</a></li>
            </ul>
        </div>

        <div class="col-md-2 col-sm-2 col-xs-6  footer_column">
            <span class="list-heading">Company</span>
            <ul class="footer-ul">
                <li><a href="http://blog.wildernesslabs.co">Blog</a></li>
                <!--<li><a href="/About">About Us</a></li>-->
            </ul>
        </div>

        <div class="col-md-2 col-sm-2 col-xs-6  footer_column connect-items">
            <span class="list-heading">Connect</span>
            <div class="col-md-4 col-sm-4 col-xs-12">
              <ul class="footer-ul">
                <li ><a href="http://github.com/wildernesslabs">GitHub</a></li>
                <li><a href="http://community.wildernesslabs.co/">Community Forums</a></li>
                
              </ul>
            </div>

            <div class="col-md-4 col-sm-4 col-xs-12">
              <ul class="footer-ul">
                <li><a href="https://twitter.com/WLabsHQ">Twitter</a></li>
                <li><a href="https://www.facebook.com/netduino/">Facebook</a></li>
              </ul>
            </div>

            <div class="col-md-4 col-sm-4 col-xs-12">
              <ul class="footer-ul">
                <li><a href="http://stackoverflow.com/search?q=netduino">Stackoverflow</a></li>
              </ul>
            </div>
        </div>
<!-- 
        <div class="col-md-2 col-sm-2 col-xs-6  footer_column">
            <span class="list-heading">&nbsp;&nbsp;</span>
            <ul class="footer-ul">
                
            </ul>
        </div> -->
    </div>

    <div class="row brown-background">
        <div class="col-md-12 ">
            <span class="footer-copyright-txt">&copy; 2017, Wilderness Labs - We Power Connected Things</span>
        </div>
    </div>
</div>
                    </div>
                </div>
             </div>
        </div>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/js/retina.min.js"></script>
        <script src="/js/retina.js"></script>
        <script>

			 $('ul.nav li.dropdown').hover(function() {
				  $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeIn(500);
				  }, function() {
				  $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeOut(500);
			 });
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
			retinajs();
			// Attempts to process all participating elements that
			// haven't been processed before.

			retinajs( [img, img, img] );
			retinajs( $('img') );
			retinajs( document.querySelectorAll('img') );
			// Attempts to process only the elements in the collection.
			// Each one still needs to be marked with `data-rjs` and
			// will still be ignored if it has already been processed.
        </script>
        
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89139221-3', 'auto');
  ga('send', 'pageview');
</script>

        
    </body>
</html>
